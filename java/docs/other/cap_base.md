# <a id="cap">`CAP`理论</a>
`CAP`理论的提出者布鲁尔在提出`CAP`猜想的时候，
并没有详细定义`Consistency`、`Availability`、`Partition Tolerance`三个单词的明确定义。

⼀般⼤家的理解是：

在理论计算机科学中，`CAP`定理（`CAP theorem`）指出对于⼀个分布式系统来说，当设计读写操作时，只能同时满足以下三点中的两个：
- 一致性（`Consistency`）：所有节点访问同⼀份最新的数据副本
- 可用性（`Availability`）：⾮故障的节点在合理的时间内返回合理的响应（不是错误或者超时的响应）。
- 分区容错性（`Partition tolerance`）：分布式系统出现⽹络分区的时候，仍然能够对外提供服务。

## ⽹络分区
分布式系统中，多个节点之前的⽹络本来是连通的，但是因为某些故障（⽐如部分节点⽹络出了问题）某些节点之间不连通了，整个⽹络就分成了⼏块区域，这就叫⽹络分区。

简单的表述：一致性、可用性、分区容忍性三者你只能同时达到其中两个，不可能同时达到。

**实际上这是⼀个误导性质的说法。**

最新的解释是：

当发⽣⽹络分区的时候，如果我们要继续服务，那么强一致性和可用性只能`2`选`1`。</br>
也就是说当⽹络分区之后`P`是前提，决定了`P`之后才有`C`和`A`的选择。</br>
也就是说分区容错性（`Partition tolerance`）我们是必须要实现的。</br>

简单的表述：`CAP`理论中分区容错性`P`是⼀定要满足的，在此基础上，只能满足一致性`C`或者可用性`A`。

因此，分布式系统理论上不可能选择`CA`架构，只能选择`CP`或者`AP`架构。 </br>
⽐如：
- `ZooKeeper`、`HBase`就是`CP`架构，
- `Cassandra`、`Eureka`就是`AP`架构
- `Nacos`不仅⽀持`CP`架构也⽀持`AP`架构。

**为啥不可能选择`CA`架构呢？**

举个例⼦：若系统出现`分区`，系统中的某个节点在进⾏写操作。
为了保证`C`（一致性）， 必须要禁⽌其他节点的读写操作，这就和`A`（可用性）发⽣冲突了。
如果为了保证`A`（可用性），其他节点的读写操作正常的话，那就和`C`（一致性）发⽣冲突了。

选择`CP`还是`AP`的关键在于当前的业务场景，没有定论，大部门业务功能是满足`AP`，但是对于需要确保强一致性的场景，如：银⾏，车票，⼀般会选择保证`CP`。

**需要补充说明的⼀点是：如果⽹络分区正常的话（系统在绝⼤部分时候所处的状态），也就说不需要保证`P`的时候，`C`和`A`能够同时保证。**

# <a id="cap">`BASE`理论</a>




----
